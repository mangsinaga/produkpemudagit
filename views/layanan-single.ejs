<%# SEO Meta Tags for Service Single Page %>
<% 
  const metaTitle = service.seo && service.seo.metaTitle ? service.seo.metaTitle : service.title + ' - ' + (settings.site ? settings.site.name : 'Produk Pemuda Santara');
  const metaDescription = service.seo && service.seo.metaDescription ? service.seo.metaDescription : service.shortDescription;
  const metaKeywords = service.seo && service.seo.metaKeywords ? service.seo.metaKeywords : '';
  const canonical = service.seo && service.seo.canonical ? service.seo.canonical : '';
  const ogImage = service.seo && service.seo.ogImage ? service.seo.ogImage : service.featuredImage;
%>

<%- contentFor('html_attribute') %>

<%- contentFor('body_attribute') %>

<%- contentFor('extra_css') %>
<style>
/* Mobile adjustments for inner pages */
@media (max-width: 768px) {
  .inner-pages-section-area {
    padding: 120px 0 30px!important;
    min-height: 200px !important;
  }
  
  .inner-header h2 {
    font-size: 28px !important;
  }
}
</style>

<%- contentFor('head') %>
<title><%= metaTitle %></title>
<meta name="description" content="<%= metaDescription %>">
<% if (metaKeywords) { %><meta name="keywords" content="<%= metaKeywords %>"><% } %>
<% if (canonical) { %><link rel="canonical" href="<%= canonical %>"><% } %>

<!-- Open Graph -->
<meta property="og:title" content="<%= metaTitle %>">
<meta property="og:description" content="<%= metaDescription %>">
<meta property="og:image" content="<%= ogImage %>">
<meta property="og:type" content="article">

<!-- Twitter Card -->
<meta name="twitter:card" content="summary_large_image">
<meta name="twitter:title" content="<%= metaTitle %>">
<meta name="twitter:description" content="<%= metaDescription %>">
<meta name="twitter:image" content="<%= ogImage %>">

<% if (service.seo && service.seo.schema) { %>
<script type="application/ld+json">
<%= service.seo.schema %>
</script>
<% } else { %>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Product",
  "name": "<%= service.title %>",
  "description": "<%= service.shortDescription %>",
  "image": "<%= service.featuredImage %>",
  "brand": {
    "@type": "Brand",
    "name": "<%= settings.site ? settings.site.name : 'Produk Pemuda Santara' %>"
  }
}
</script>
<% } %>

<%- contentFor('content') %>
<%- include('partials/header/navbar5') %>

<!-- ===== HERO AREA STARTS ======= -->
<div class="inner-pages-section-area" style="background-image: url(/img/all-images/bg/bg1.png); background-position: center; background-repeat: no-repeat; background-size: cover;">
  <div class="container">
    <div class="row">
      <div class="col-lg-12 m-auto">
        <div class="inner-header text-center">
          <h2><%= service.title %></h2>
          <div class="space24"></div>            
        </div>
      </div>
    </div>
  </div>
</div>
<!-- ===== HERO AREA ENDS ======= -->

<!-- Service Single Content -->
<div class="service-single-section sp1">
  <div class="container">
    <div class="row">
      <div class="col-lg-8">
        <div class="service-single-content">
          <div class="service-featured-image mb-4">
            <img src="<%= service.featuredImage %>" alt="<%= service.title %>" class="img-fluid rounded" style="width: 100%; max-height: 400px; object-fit: cover;">
          </div>
          
          <div class="service-meta mb-4">
            <% if (category) { %>
            <span class="badge bg-primary me-2"><%= category.name %></span>
            <% } %>
            <% if (serviceTags && serviceTags.length > 0) { %>
              <% serviceTags.forEach(tag => { %>
              <span class="badge bg-secondary me-1"><%= tag.name %></span>
              <% }) %>
            <% } %>
          </div>

          <div class="service-content">
            <%- service.content %>
          </div>
        </div>
      </div>
      
      <div class="col-lg-4">
        <div class="service-sidebar">
          <!-- Service Info Card -->
          <div class="sidebar-widget mb-4" style="background: #f8f9fa; padding: 25px; border-radius: 12px;">
            <h4 style="margin-bottom: 20px; color: #1e3a8a;">Informasi Layanan</h4>
            <ul style="list-style: none; padding: 0; margin: 0;">
              <% if (category) { %>
              <li style="padding: 10px 0; border-bottom: 1px solid #e2e8f0;">
                <strong>Kategori:</strong> <%= category.name %>
              </li>
              <% } %>
              <li style="padding: 10px 0; border-bottom: 1px solid #e2e8f0;">
                <strong>Terakhir Update:</strong> <%= service.updatedAt %>
              </li>
            </ul>
          </div>

          <!-- Specification Section -->
          <% if (service.specificationImage) { %>
          <div class="sidebar-widget mb-4" style="background: #f8f9fa; padding: 25px; border-radius: 12px;">
            <h4 style="margin-bottom: 20px; color: #1e3a8a;"><%= service.specificationLabel || 'Spesifikasi' %></h4>
            <div class="specification-image">
              <img src="<%= service.specificationImage %>" alt="<%= service.specificationLabel || 'Spesifikasi' %>" style="width: 100%; border-radius: 8px; cursor: pointer;" onclick="openSpecModal(this.src)">
              <small style="display: block; margin-top: 10px; color: #666; text-align: center;">Klik gambar untuk memperbesar</small>
            </div>
          </div>
          <% } %>

          <!-- Related Services -->
          <% if (relatedServices && relatedServices.length > 0) { %>
          <div class="sidebar-widget" style="background: #f8f9fa; padding: 25px; border-radius: 12px;">
            <h4 style="margin-bottom: 20px; color: #1e3a8a;">Layanan Terkait</h4>
            <% relatedServices.forEach(related => { %>
            <div class="related-service-item mb-3" style="display: flex; gap: 15px; align-items: center;">
              <img src="<%= related.featuredImage %>" alt="<%= related.title %>" style="width: 60px; height: 60px; object-fit: cover; border-radius: 8px;">
              <div>
                <a href="/produk/<%= related.slug %>" style="font-weight: 600; color: #1e293b; text-decoration: none;"><%= related.title %></a>
              </div>
            </div>
            <% }) %>
          </div>
          <% } %>
          
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Specification Image Modal -->
<div id="specModal" style="display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.9); cursor: pointer;" onclick="closeSpecModal()">
  <span style="position: absolute; top: 20px; right: 35px; color: #fff; font-size: 40px; font-weight: bold; cursor: pointer;">&times;</span>
  <img id="specModalImg" style="margin: auto; display: block; max-width: 90%; max-height: 90%; position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); border-radius: 8px;">
</div>

<%- contentFor('extra_javascript') %>
<script>
function openSpecModal(src) {
  document.getElementById('specModal').style.display = 'block';
  document.getElementById('specModalImg').src = src;
  document.body.style.overflow = 'hidden';
}

function closeSpecModal() {
  document.getElementById('specModal').style.display = 'none';
  document.body.style.overflow = 'auto';
}

document.addEventListener('keydown', function(e) {
  if (e.key === 'Escape') {
    closeSpecModal();
  }
});
</script>
